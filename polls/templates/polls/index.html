{% extends "base.html" %}

{% block title %}Latest Polls | Polls{% endblock %}

{% block content %}
<div class="row">
    <div class="col-lg-8">
        <h1 class="mb-4">Latest Polls</h1>

        {% if slogan %}
            <div class="alert alert-warning mb-4">
                <strong>{{ slogan }}</strong>
            </div>
        {% endif %}

        {% if latest_question_list %}
            <div class="row">
                {% for question in latest_question_list %}
                    <div class="col-md-6 mb-4">
                        <div class="card h-100">
                            <div class="card-body d-flex flex-column">
                                <h5 class="card-title">{{ question.question_text }}</h5>

                                <p class="card-text text-muted small">
                                    {{ question.pub_date|date:"M d, Y H:i" }}
                                </p>

                                <p class="card-text flex-grow-1">
                                    <strong>Votes:</strong>
                                    {{ question.get_total_votes }}
                                </p>

                                <div class="d-flex gap-2">
                                    <a href="{% url 'polls:detail' question.id %}" class="btn btn-primary btn-sm flex-grow-1">
                                        Vote
                                    </a>
                                    <a href="{% url 'polls:results' question.id %}" class="btn btn-info btn-sm flex-grow-1">
                                        Results
                                    </a>
                                    {% if user.is_staff %}
                                        <a href="{% url 'polls:poll_edit' question.id %}" class="btn btn-warning btn-sm">
                                            Edit
                                        </a>
                                    {% endif %}
                                </div>
                            </div>
                        </div>
                    </div>
                {% endfor %}
            </div>
        {% else %}
            <div class="alert alert-info">
                <h4>No polls available</h4>
                <p>There are no polls yet. {% if user.is_staff %}<a href="{% url 'polls:poll_new' %}">Create one!</a>{% endif %}</p>
            </div>
        {% endif %}
    </div>

    <div class="col-lg-4">
        <div class="card">
            <div class="card-body">
                <h5 class="card-title">How it works</h5>
                <ul class="mb-0">
                    <li>Browse available polls</li>
                    <li>Vote on your favorite option</li>
                    <li>View results instantly</li>
                    {% if user.is_authenticated and user.is_staff %}
                        <li>Create your own polls</li>
                    {% endif %}
                </ul>
            </div>
        </div>

        {% if user.is_authenticated %}
            <div class="card mt-3">
                <div class="card-body">
                    <h5 class="card-title">ðŸ‘¤ Your Info</h5>
                    <p class="mb-1"><strong>Username:</strong> {{ user.username }}</p>
                    <p class="mb-1"><strong>Email:</strong> {{ user.email }}</p>
                    {% if user.is_staff %}
                        <p class="mb-0"><span class="badge bg-danger">Staff</span></p>
                    {% endif %}
                </div>
            </div>
        {% else %}
            <div class="card mt-3">
                <div class="card-body">
                    <h5 class="card-title">Not logged in?</h5>
                    <p class="mb-3">Join our community to vote and create polls!</p>
                    <a href="{% url 'account_login' %}" class="btn btn-primary btn-sm w-100">Login</a>
                    <a href="{% url 'account_signup' %}" class="btn btn-success btn-sm w-100 mt-2">Register</a>
                </div>
            </div>
        {% endif %}
    </div>
</div>
{% endblock %}